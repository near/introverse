(this.webpackJsonpintroverse=this.webpackJsonpintroverse||[]).push([[0],{111:function(e,t){},113:function(e,t){},134:function(e,t){},140:function(e,t){},157:function(e,t,n){"use strict";n.r(t);var o=n(1),a=n.n(o),r=n(26),c=n(0),i=n.n(c),s=n(73),l=n.n(s),d=n(74),u=n(75),p=n(83),h=n(76),g=n(15),w=n(84),f=n(37),m=n(18),v=(n(90),n(77)),E=n.n(v),b=n(78),O=n.n(b),S=(n(91),n(79)),y=n.n(S),k={header:!0,dynamicTyping:!0,skipEmptyLines:!0,transformHeader:function(e){return e.toLowerCase().replace(/\W/g,"_")}},I=function(e){var t=function(e){return e.map((function(e){var t=e.first_name,n=e.last_name;return"".concat(t," ").concat(n)}))};return i.a.createElement("div",{className:"container"},i.a.createElement(y.a,{cssClass:"react-csv-input",label:e.label,onFileLoaded:function(n,o){e.handleData(t(n))},parserOptions:k}))};n(94);function N(e,t){return window.localStorage.setItem(e,JSON.stringify(t))}function C(e){return JSON.parse(window.localStorage.getItem(e))}var A=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(p.a)(this,Object(h.a)(t).call(this,e))).state={login:!1,speech:null,profileName:"there"},n.signedInFlow=n.signedInFlow.bind(Object(g.a)(n)),n.requestSignIn=n.requestSignIn.bind(Object(g.a)(n)),n.requestSignOut=n.requestSignOut.bind(Object(g.a)(n)),n.signedOutFlow=n.signedOutFlow.bind(Object(g.a)(n)),n.handleConnectionsData=n.handleConnectionsData.bind(Object(g.a)(n)),n.handleProfileData=n.handleProfileData.bind(Object(g.a)(n)),n.uploading=!1,n}return Object(w.a)(t,e),Object(u.a)(t,[{key:"init",value:function(){var e=this,t=C("profile"),n=C("connections"),o=!!C("graphUploaded");console.log(t,n),this.setState({profileAdded:!!t,profile:t,connectionsAdded:!!n,connections:n,graphUploaded:o},(function(){e.handleData()}))}},{key:"componentDidMount",value:function(){this.init(),this.props.wallet.isSignedIn()?this.signedInFlow():this.signedOutFlow()}},{key:"signedInFlow",value:function(){var e=Object(r.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("come in sign in flow"),this.setState({login:!0}),e.next=4,this.props.wallet.getAccountId();case 4:e.sent,window.location.search.includes("account_id")&&window.location.replace(window.location.origin+window.location.pathname);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"requestSignIn",value:function(){var e=Object(r.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"Sasha's Services",e.next=3,this.props.wallet.requestSignIn("","Sasha's Services");case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"requestSignOut",value:function(){N("profile",null),N("connections",null),this.state({profile:"there",login:!1}),this.props.wallet.signOut(),setTimeout(this.signedOutFlow,500),console.log("after sign out",this.props.wallet.isSignedIn())}},{key:"signedOutFlow",value:function(){window.location.search.includes("account_id")&&window.location.replace(window.location.origin+window.location.pathname),this.setState({login:!1,speech:null})}},{key:"handleData",value:function(){var e=this;if(this.state.connections&&this.state.profileName&&!this.uploading&&!this.state.graphUploaded){this.uploading=!0,console.log("Uploading your data...");for(var t=Promise.resolve(),n=function(n){t=t.then((function(){return e.props.contract.add_edges({fullname:e.state.profileName,edges:e.state.connections.slice(n,n+50)},2e15).then((function(){console.log("Uploading "+n+" out of "+e.state.connections.length+" DONE!!!")}))}))},o=0;o<this.state.connections.length;o+=50)n(o);t.then((function(){console.log("all done"),N("graphUploaded",!0),e.setState({graphUploaded:!0})}))}}},{key:"handleConnectionsData",value:function(e){var t=this;e&&(this.setState({connections:e,connectionsAdded:!0},(function(){t.handleData()})),N("connections",e),this.handleData())}},{key:"handleProfileData",value:function(e){var t=this,n=e[0];e&&(this.setState({profileName:n,profileAdded:!0},(function(){t.handleData()})),N("profile",n))}},{key:"render",value:function(){var e=this,t={fontSize:"1.5rem",color:"#0072CE",textShadow:"1px 1px #D1CCBD"};return i.a.createElement(f.a,null,i.a.createElement(m.c,null,i.a.createElement(m.a,{path:"/",render:function(n){return i.a.createElement("div",{className:"App-header"},i.a.createElement("div",{className:"image-wrapper"},e.state.login?i.a.createElement("img",{className:"logo",src:O.a,alt:"INTROVERSE logo"}):i.a.createElement("img",{className:"logo",src:E.a,alt:"INTROVERSE logo"}),i.a.createElement("p",{style:t},"Hi, ",e.state.profileName,"!"),e.state.connectionsAdded&&i.a.createElement(f.b,{to:"/connections"}," View My Connections ")),i.a.createElement("div",null,e.state.login?i.a.createElement("div",{style:{color:"black"}},i.a.createElement("div",null,e.state.profileAdded?i.a.createElement("p",null,'"Profile Added"'):i.a.createElement(I,{label:"Add your Profile here: ",handleData:e.handleProfileData}),e.state.connectionsAdded?i.a.createElement("p",null,'"Connections Added"'):i.a.createElement(I,{label:"Add your Connections here: ",handleData:e.handleConnectionsData}))):"Login to upload your homies"),i.a.createElement("div",null,e.state.login?i.a.createElement("button",{onClick:e.requestSignOut},"Log out"):i.a.createElement("button",{onClick:e.requestSignIn},"Log in with NEAR")))}}),i.a.createElement(m.a,{path:"/connections",render:function(e){return i.a.createElement(I,e)}})))}}]),t}(c.Component),U=n(82),D=n.n(U),j=n(22);n(40);function x(){return(x=Object(r.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.nearConfig=D()("production"),console.log("nearConfig",window.nearConfig),e.next=4,j.connect(Object.assign({deps:{keyStore:new j.keyStores.BrowserLocalStorageKeyStore}},window.nearConfig));case 4:return window.near=e.sent,window.walletAccount=new j.WalletAccount(window.near),window.accountId=window.walletAccount.getAccountId(),e.next=9,new j.Account(window.near.connection,window.accountId);case 9:return t=e.sent,e.next=12,new j.Contract(t,window.nearConfig.contractName,{viewMethods:["search","get_graph","get_on_chain_graph","is_on_chain"],changeMethods:["add_edges"],sender:window.accountId});case 12:window.contract=e.sent;case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}window.nearInitPromise=function(){return x.apply(this,arguments)}().then((function(){l.a.render(i.a.createElement(A,{contract:window.contract,wallet:window.walletAccount}),document.getElementById("root"))})).catch(console.error)},77:function(e,t,n){e.exports=n.p+"static/media/logo.5254dfbb.png"},78:function(e,t,n){e.exports=n.p+"static/media/logo2.c7477cc4.png"},82:function(e,t){e.exports=function(e){switch(e){case"production":case"development":return{networkId:"default",nodeUrl:"https://rpc.nearprotocol.com",contractName:"introverse",walletUrl:"https://wallet.nearprotocol.com",helperUrl:"https://near-contract-helper.onrender.com"};case"staging":return{networkId:"staging",nodeUrl:"https://staging-rpc.nearprotocol.com/",contractName:"introverse",walletUrl:"https://near-wallet-staging.onrender.com",helperUrl:"https://near-contract-helper-staging.onrender.com"};case"local":return{networkId:"local",nodeUrl:"http://localhost:3030",keyPath:"".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).HOME,"/.near/validator_key.json"),walletUrl:"http://localhost:4000/wallet",contractName:"introverse"};case"test":case"ci":return{networkId:"shared-test",nodeUrl:"http://shared-test.nearprotocol.com:3030",contractName:"introverse",masterAccount:"test.near"};case"ci-staging":return{networkId:"shared-test-staging",nodeUrl:"http://staging-shared-test.nearprotocol.com:3030",contractName:"introverse",masterAccount:"test.near"};case"tatooine":return{networkId:"tatooine",nodeUrl:"https://rpc.tatooine.nearprotocol.com",contractName:"introverse",walletUrl:"https://wallet.tatooine.nearprotocol.com"};default:throw Error("Unconfigured environment '".concat(e,"'. Can be configured in src/config.js."))}}},85:function(e,t,n){e.exports=n(157)},90:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},91:function(e,t,n){e.exports=n.p+"static/media/near.53ae53eb.svg"},94:function(e,t,n){}},[[85,1,2]]]);
//# sourceMappingURL=main.1356f695.chunk.js.map