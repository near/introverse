{"version":3,"sources":["UploadCSV.js","utils.js","App.js","index.js","assets/logo.png","assets/logo2.png","config.js","assets/logo.svg","assets/near.svg"],"names":["parseOptions","header","dynamicTyping","skipEmptyLines","transformHeader","toLowerCase","replace","reader","props","parseNames","data","map","line","firstName","first_name","lastName","last_name","className","cssClass","label","onFileLoaded","fileName","handleData","parserOptions","stashLocally","name","window","localStorage","setItem","JSON","stringify","grabFromStorage","parse","getItem","App","state","login","speech","profileName","signedInFlow","bind","requestSignIn","requestSignOut","signedOutFlow","handleConnectionsData","handleProfileData","uploading","profile","connections","graphUploaded","console","log","this","setState","profileAdded","connectionsAdded","init","wallet","isSignedIn","getAccountId","location","search","includes","origin","pathname","signOut","setTimeout","p","Promise","resolve","i","then","contract","add_edges","fullname","edges","slice","length","fullName","style","fontSize","color","textShadow","exact","path","render","src","introverselogo2","alt","introverselogo","to","onClick","Component","a","nearConfig","getConfig","process","nearlib","Object","assign","deps","keyStore","BrowserLocalStorageKeyStore","near","walletAccount","accountId","connection","acct","contractName","viewMethods","changeMethods","sender","nearInitPromise","initContract","ReactDOM","document","getElementById","catch","error","module","exports","env","networkId","nodeUrl","walletUrl","helperUrl","keyPath","HOME","masterAccount","Error"],"mappings":"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","file":"static/js/main.ede3063d.chunk.js","sourcesContent":["import React from \"react\";\nimport CSVReader from \"react-csv-reader\";\n\nconst parseOptions = {\n  header: true,\n  dynamicTyping: true,\n  skipEmptyLines: true,\n  transformHeader: header => header.toLowerCase().replace(/\\W/g, \"_\")\n};\n\nconst reader = props => {\n\n  const handleForce = (data, fileName) => {\n    // console.log(parseNames(data));\n    props.handleData(parseNames(data));\n  };\n\n  const parseNames = data => {\n    return data.map(line => {\n      let firstName = line.first_name;\n      let lastName = line.last_name;\n      return  `${firstName} ${lastName}`\n    });\n  }\n\n  return (\n    <div className=\"container\">\n      <CSVReader\n        cssClass=\"react-csv-input\"\n        label={props.label}\n        onFileLoaded={handleForce}\n        parserOptions={parseOptions}\n      />\n    </div>\n  )\n};\n\nexport default reader;\n","\n  export function stashLocally(name, data) {\n    return window.localStorage.setItem(name, JSON.stringify(data));\n  }\n\n  export function grabFromStorage(name) {\n    return JSON.parse(window.localStorage.getItem(name));\n  }\n","import React, { Component } from 'react';\nimport { BrowserRouter as Router, Link, Route, Switch } from 'react-router-dom';\nimport logo from './assets/logo.svg';\nimport introverselogo from './assets/logo.png';\nimport introverselogo2 from './assets/logo2.png';\nimport near from './assets/near.svg';\nimport Reader from './UploadCSV.js'\nimport Connections from './UploadCSV.js'\nimport './App.css';\nimport { stashLocally, grabFromStorage } from './utils.js'\n\n// import { makeStyles } from '@material-ui/styles';\nconst GAS = 2_000_000_000_000_000;\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      login: false,\n      speech: null,\n      profileName: \"there\"\n    }\n    this.signedInFlow = this.signedInFlow.bind(this);\n    this.requestSignIn = this.requestSignIn.bind(this);\n    this.requestSignOut = this.requestSignOut.bind(this);\n    this.signedOutFlow = this.signedOutFlow.bind(this);\n    this.handleConnectionsData = this.handleConnectionsData.bind(this);\n    this.handleProfileData = this.handleProfileData.bind(this);\n    this.uploading = false;\n  }\n\n  init() {\n    let profile = grabFromStorage(\"profile\");\n    let connections = grabFromStorage(\"connections\");\n    let graphUploaded = !!grabFromStorage(\"graphUploaded\");\n\n    console.log(profile, connections)\n    this.setState({\n      profileAdded: !!profile,\n      profile: profile,\n      connectionsAdded: !!connections,\n      connections: connections,\n      graphUploaded,\n    }, () => {\n      this.handleData();\n    })\n  }\n\n  componentDidMount() {\n    this.init();\n    let loggedIn = this.props.wallet.isSignedIn();\n    if (loggedIn) {\n      this.signedInFlow();\n    } else {\n      this.signedOutFlow();\n    }\n  }\n\n  async signedInFlow() {\n    console.log(\"come in sign in flow\")\n    this.setState({\n      login: true,\n    })\n    const accountId = await this.props.wallet.getAccountId()\n    if (window.location.search.includes(\"account_id\")) {\n      window.location.replace(window.location.origin + window.location.pathname)\n    }\n  }\n\n  async requestSignIn() {\n    const appTitle = \"Sasha's Services\";\n    await this.props.wallet.requestSignIn(\n      \"\", // window.nearConfig.contractName,  // Uncomment once the allowance is large enough\n      appTitle\n    )\n  }\n\n  requestSignOut() {\n    stashLocally(\"profile\", null);\n    stashLocally(\"connections\", null);\n    stashLocally(\"numUploaded\", 0);\n    this.setState({\n      profile: \"there\",\n      login: false\n    })\n    this.props.wallet.signOut();\n    setTimeout(this.signedOutFlow, 500);\n    console.log(\"after sign out\", this.props.wallet.isSignedIn())\n  }\n\n  signedOutFlow() {\n    if (window.location.search.includes(\"account_id\")) {\n      window.location.replace(window.location.origin + window.location.pathname)\n    }\n    this.setState({\n      login: false,\n      speech: null\n    })\n  }\n\n  handleData() {\n    if (this.state.connections && this.state.profileName && !this.uploading && !this.state.graphUploaded) {\n      this.uploading = true;\n      console.log(\"Uploading your data...\");\n      let p = Promise.resolve();\n      for (let i = grabFromStorage(\"numUploaded\"); i < this.state.connections.length; i += 50) {\n        p = p.then(() => this.props.contract.add_edges({\n          fullname: this.state.profileName,\n          edges: this.state.connections.slice(i, i + 50),\n        }, GAS).then(() => {\n          console.log(\"Uploading \" + i + \" out of \" + this.state.connections.length +  \" DONE!!!\");\n          stashLocally(\"numUploaded\", i + 50);\n        }));\n      }\n      p.then(() => {\n        console.log(\"all done\");\n        stashLocally(\"graphUploaded\", true);\n        this.setState({\n          graphUploaded: true,\n        })\n      })\n    }\n  }\n\n  handleConnectionsData(data) {\n    // console.log(data);\n    // pass data to the server\n    if (!!data){\n      this.setState({\n        connections: data,\n        connectionsAdded: true\n      }, () => {\n        this.handleData();\n      });\n      stashLocally(\"connections\", data);\n      this.handleData();\n    }\n\n  }\n\n  handleProfileData(data) {\n    let fullName = data[0]\n    if (!!data){\n      this.setState({\n        profileName: fullName,\n        profileAdded: true\n      }, () => {\n        this.handleData();\n      });\n      stashLocally(\"profile\", fullName);\n    }\n  }\n\n  render() {\n    let style = {\n      fontSize: \"1.5rem\",\n      color: \"#0072CE\",\n      textShadow: \"1px 1px #D1CCBD\"\n    }\n    return (\n      <Router>\n        <Switch>\n          <Route\n            exact\n            path=\"/\"\n            render={props => \n              <div className=\"App-header\">\n                <div className=\"image-wrapper\">\n                  {this.state.login ?\n                    <img className=\"logo\" src={introverselogo2} alt=\"INTROVERSE logo\" />\n                  :\n                    <img className=\"logo\" src={introverselogo} alt=\"INTROVERSE logo\" />\n                  }\n                  <p style={style}>Hi, {this.state.profileName}!</p>\n\n                  {this.state.connectionsAdded && (\n                    <Link to=\"/connections\"> View My Connections </Link>\n                  )}\n                </div>\n                <div>\n                  {this.state.login ? \n                    <div style={{color:\"black\"}}>\n                      \n                      <div>\n                        {this.state.profileAdded ? <p>\"Profile Added\"</p> :\n                          <Reader label={\"Add your Profile here: \"} handleData={this.handleProfileData} />\n                        }\n                        {this.state.connectionsAdded ? <p>\"Connections Added\"</p> : \n                          <Reader label={\"Add your Connections here: \"} handleData={this.handleConnectionsData} />\n                        }\n                      </div>\n                    </div>\n                    :\n                    \"Login to upload your homies\"\n                  }\n                </div>\n                <div>\n                  {this.state.login ? <button onClick={this.requestSignOut}>Log out</button>\n                    : <button onClick={this.requestSignIn}>Log in with NEAR</button>}\n                </div>\n\n              </div>} />\n          <Route \n            path=\"/connections\"\n            render={props => <Connections {...props}/>} />\n        </Switch> \n      </Router>\n    )\n  }\n\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport getConfig from './config.js';\nimport * as nearlib from 'nearlib';\n// This is to help with building\nimport 'regenerator-runtime/runtime'\n\n// Initializing contract\nasync function initContract() {\n    window.nearConfig = getConfig(process.env.NODE_ENV || 'development')\n    console.log(\"nearConfig\", window.nearConfig);\n\n    // Initializing connection to the NEAR DevNet.\n    window.near = await nearlib.connect(Object.assign({ deps: { keyStore: new nearlib.keyStores.BrowserLocalStorageKeyStore() } }, window.nearConfig));\n    \n    // Needed to access wallet login\n    window.walletAccount = new nearlib.WalletAccount(window.near);\n    \n    // Getting the Account ID. If unauthorized yet, it's just empty string.\n    window.accountId = window.walletAccount.getAccountId();\n\n    // Initializing our contract APIs by contract name and configuration.\n    let acct = await new nearlib.Account(window.near.connection, window.accountId);\n    window.contract = await new nearlib.Contract(acct, window.nearConfig.contractName, {\n        // View methods are read only. They don't modify the state, but usually return some value.\n        viewMethods: ['search', 'get_graph', 'get_on_chain_graph', 'is_on_chain'],\n        // Change methods can modify the state. But you don't receive the returned value when called.\n        changeMethods: ['add_edges'],\n        // Sender is the account ID to initialize transactions.\n        sender: window.accountId\n    });\n}\n\nwindow.nearInitPromise = initContract().then(() => {\n  ReactDOM.render(<App contract={window.contract} wallet={window.walletAccount} />,\n    document.getElementById('root')\n  );\n}).catch(console.error)","module.exports = __webpack_public_path__ + \"static/media/logo.5254dfbb.png\";","module.exports = __webpack_public_path__ + \"static/media/logo2.c7477cc4.png\";","const CONTRACT_NAME = 'introverse';\n\nfunction getConfig(env) {\n    switch (env) {\n\n    case 'production':\n    case 'development':\n        return {\n            networkId: 'default',\n            nodeUrl: 'https://rpc.nearprotocol.com',\n            contractName: CONTRACT_NAME,\n            walletUrl: 'https://wallet.nearprotocol.com',\n            helperUrl: 'https://near-contract-helper.onrender.com',\n        };\n    case 'staging':\n        return {\n            networkId: 'staging',\n            nodeUrl: 'https://staging-rpc.nearprotocol.com/',\n            contractName: CONTRACT_NAME,\n            walletUrl: 'https://near-wallet-staging.onrender.com',\n            helperUrl: 'https://near-contract-helper-staging.onrender.com',\n        };\n    case 'local':\n        return {\n            networkId: 'local',\n            nodeUrl: 'http://localhost:3030',\n            keyPath: `${process.env.HOME}/.near/validator_key.json`,\n            walletUrl: 'http://localhost:4000/wallet',\n            contractName: CONTRACT_NAME,\n        };\n    case 'test':\n    case 'ci':\n        return {\n            networkId: 'shared-test',\n            nodeUrl: 'http://shared-test.nearprotocol.com:3030',\n            contractName: CONTRACT_NAME,\n            masterAccount: 'test.near',\n        };\n    case 'ci-staging':\n        return {\n            networkId: 'shared-test-staging',\n            nodeUrl: 'http://staging-shared-test.nearprotocol.com:3030',\n            contractName: CONTRACT_NAME,\n            masterAccount: 'test.near',\n        };\n    case 'tatooine':\n        return {\n            networkId: 'tatooine',\n            nodeUrl: 'https://rpc.tatooine.nearprotocol.com',\n            contractName: CONTRACT_NAME,\n            walletUrl: 'https://wallet.tatooine.nearprotocol.com',\n        };\n    default:\n        throw Error(`Unconfigured environment '${env}'. Can be configured in src/config.js.`);\n    }\n}\n\nmodule.exports = getConfig;\n","module.exports = __webpack_public_path__ + \"static/media/logo.5d5d9eef.svg\";","module.exports = __webpack_public_path__ + \"static/media/near.53ae53eb.svg\";"],"sourceRoot":""}